<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Dashboard | Cal-FIT</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
  <link rel="preconnect" href="https://fonts.googleapis.com">
</head>

<body>

  <script src="https://unpkg.com/@studio-freight/lenis@1.0.42/dist/lenis.min.js"></script>

  <header>
    <div class="logo">Cal-FIT</div>
    <nav class="main-nav">
      <a href="{{ url_for('dashboard') }}">Home</a>
      <a href="#explore">Explore</a>
      <a href="{{ url_for('about') }}">About Us</a>
      <a href="{{ url_for('profile') }}">Profile</a>
    </nav>
  </header>

  <section class="hero-section">
    <div class="hero-text">
      <h1>Your Fastest Path to Fitness</h1>
      <p>Cal-FIT helps you make smarter food choices, one scan at a time.</p>
      <a href="#" class="hero-btn">Get App</a>
    </div>
  </section>

  <div class="scroll-stack-container">

    <!-- New Section 1: Barcode Question -->
    <section class="intro-section stack-card">
      <div class="intro-content">
        <div class="intro-text">
          <h2>Do you know how to read this?</h2>
        </div>
        <div class="intro-image">
          <img src="{{ url_for('static', filename='images/barcodeImage_1.png') }}" alt="Barcode">
        </div>
      </div>
    </section>

    <!-- New Section 2: Healthy Question -->
    <section class="intro-section stack-card">
      <div class="intro-content">
        <div class="intro-text">
          <h2>Or if this is healthy for you?</h2>
        </div>
        <div class="intro-image">
          <img src="{{ url_for('static', filename='images/barcodeImage_2.png') }}" alt="Nutrition Label">
        </div>
      </div>
    </section>

    <!-- New Section 3: Solution Text -->
    <section class="solution-section stack-card">
      <div class="solution-content">
        <h2>If not, there's no need to worry!</h2>
        <p class="solution-subtitle">CalFit scans these for you and gives insights</p>
        <p class="solution-cta">Start scanning to see more</p>
      </div>
    </section>

    <section class="card-section stack-card">
      <div class="card-wrapper">
        <div class="card card-left" id="scan-card">
          <div class="card-inner">
            <div class="hover-bar"></div>
            <div class="card-content1">
              <h3>Scan & Analyze</h3>
              <p>Upload a food label and instantly check for health risks.</p>
              <a href="{{ url_for('scan_label') }}">Start Scan</a>
            </div>
            <img src="{{ url_for('static', filename='images/scan1.png') }}" class="card-img slideshow-img"
              id="scan-image" alt="Scan Image">
          </div>
        </div>
      </div>
    </section>

    <section class="trust stack-card">
      <h3>Cal-FIT</h3>
      <p>Your partner in smart food decisions and better health.</p>
      <h1>
        Cal-FIT securely collects and analyzes nutritional data...
      </h1>
      <div class="company-logos">
        <div class="company">
          <img id="company-1" src="{{ url_for('static', filename='images/FDA.png') }}" alt="FDA">
          <p>U.S. Food and Drug Administration</p>
        </div>
        <div class="company">
          <img id="company-2" src="{{ url_for('static', filename='images/FSSAI.png') }}" alt="FSSAI">
          <p>Food Safety and Standards Authority of India</p>
        </div>
        <div class="company">
          <img id="company-3" src="{{ url_for('static', filename='images/WHO.png') }}" alt="WHO">
          <p>World Health Organization</p>
        </div>
      </div>
    </section>

    <div class="stack-spacer"></div>

  </div>
  <footer class="footer">
    <div class="footer-content">
      <div class="footer-right">
        <p>&copy; 2025 Cal-FIT. All rights reserved.</p>
        <div class="socials">
          <a href="mailto:anish22it@mes.ac.in" target="_blank" rel="noopener noreferrer">
            <img src="{{ url_for('static', filename='icons/gmail.svg') }}" alt="Email">
          </a>
          <a href="https://www.linkedin.com/in/anishbhosle04/" target="_blank" rel="noopener noreferrer">
            <img src="{{ url_for('static', filename='icons/linkedin.svg') }}" alt="LinkedIn">
          </a>
          <a href="https://github.com/BhosleAnish" target="_blank" rel="noopener noreferrer">
            <img src="{{ url_for('static', filename='icons/github.svg') }}" alt="GitHub">
          </a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    // --- Original Scan Card Hover Logic ---
    const scanCard = document.getElementById('scan-card');
    const scanImage = document.getElementById('scan-image');
    const scanImages = [
      "{{ url_for('static', filename='images/scan1.png') }}",
      "{{ url_for('static', filename='images/scan2.png') }}",
      "{{ url_for('static', filename='images/scan3.png') }}"
    ];
    let currentIndex = 0;
    let intervalId = null;
    scanCard.addEventListener('mouseenter', () => {
      intervalId = setInterval(() => {
        currentIndex = (currentIndex + 1) % scanImages.length;
        scanImage.src = scanImages[currentIndex];
      }, 1000);
    });
    scanCard.addEventListener('mouseleave', () => {
      clearInterval(intervalId);
      currentIndex = 0;
      scanImage.src = scanImages[0];
    });

    // 1. Initialize Lenis for smooth scrolling
    const lenis = new Lenis({
      lerp: 0.1,
      duration: 1.2,
      smoothWheel: true,
    });

    function raf(time) {
      lenis.raf(time);
      requestAnimationFrame(raf);
    }
    requestAnimationFrame(raf);

    // 2. Define stacking parameters
    const STICKY_TOP_PX = 100;
    const BASE_SCALE = 0.9;
    const STACK_OFFSET = 10;

    // 3. Listen for the 'scroll' event from Lenis
    lenis.on('scroll', (e) => {
      const cards = document.querySelectorAll(".stack-card");
      if (!cards.length) return;

      let topStuckCardIndex = -1;
      cards.forEach((card, index) => {
        const rect = card.getBoundingClientRect();
        if (rect.top <= STICKY_TOP_PX) {
          topStuckCardIndex = index;
        }
      });

      cards.forEach((card, index) => {
        const stackDepth = topStuckCardIndex - index;

        if (topStuckCardIndex === -1) {
          card.style.transform = 'scale(1) translateY(0)';
          card.style.zIndex = index;
        } else if (index <= topStuckCardIndex) {
          if (stackDepth > 0) {
            const scale = Math.pow(BASE_SCALE, stackDepth);
            const translateY = stackDepth * STACK_OFFSET;
            card.style.transform = `scale(${scale}) translateY(${translateY}px)`;
            card.style.zIndex = index;
          } else {
            card.style.transform = 'scale(1) translateY(0)';
            card.style.zIndex = topStuckCardIndex;
          }
        } else {
          card.style.transform = 'scale(1) translateY(0)';
          card.style.zIndex = cards.length;
        }
      });
    });
  </script>
</body>

</html>